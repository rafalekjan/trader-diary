{% extends "base.html" %}
{% block title %}Score{% endblock %}
{% block content %}
<div class="page-header">
    <div>
        <h2>Score</h2>
        <p class="page-subtitle">SPY (1D) Market Gatekeeper: direction, regime, location, risk, and market permission.</p>
    </div>
</div>

<form id="score-form" class="card analysis-builder scoring-builder" autocomplete="off">
    <div class="analysis-section">
        <div class="scoring-header-row">
            <h3>SPY (1D) - Market Gatekeeper</h3>
            <div class="scoring-header-summary">
                <div><strong>Market Score:</strong> <span id="score-market-score">0 / 100</span></div>
                <div><strong>Permission:</strong> <span id="score-market-permission">No data</span></div>
                <div><strong>Risk State:</strong> <span id="score-risk-state">No data</span></div>
                <div><strong>Size:</strong> <span id="score-size-modifier">-</span></div>
            </div>
        </div>

        <div class="analysis-subsection score-section-a">
            <h4>A. Regime & Direction</h4>
            <div class="scoring-stage-grid">
                <div class="form-group">
                    <label>Market Regime <span class="help-icon" data-tooltip="Trend = HH/HL lub LL/LH + nachylone MA. Range = overlap Ĺ›wiec + pĹ‚askie MA. Volatile = duĹĽe Ĺ›wiece/ATR% wysokie, czÄ™ste zwroty. ReĹĽim steruje tym, czy swing ma edge.">?</span></label>
                    <div class="checkbox-group scoring-option-grid">
                        <label class="checkbox-label"><input type="radio" name="score_spy_regime" value="trend_up"><span class="checkbox-text">Trend Up</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_spy_regime" value="trend_down"><span class="checkbox-text">Trend Down</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_spy_regime" value="range"><span class="checkbox-text">Range</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_spy_regime" value="volatile"><span class="checkbox-text">Volatile-Unstable</span></label>
                    </div>
                </div>
                <div class="form-group">
                    <label>Bias <span class="help-icon" data-tooltip="Preferowany kierunek zagraĹ„ na akcjach. Nie 'co moĹĽe', tylko 'co ma statystycznie sens' w tym reĹĽimie.">?</span></label>
                    <div class="checkbox-group scoring-option-grid">
                        <label class="checkbox-label"><input type="radio" name="score_spy_bias" value="bullish"><span class="checkbox-text">Bullish</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_spy_bias" value="bearish"><span class="checkbox-text">Bearish</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_spy_bias" value="neutral"><span class="checkbox-text">Neutral</span></label>
                    </div>
                    <label class="checkbox-label" style="margin-top:8px;">
                        <input type="checkbox" name="score_spy_bias_manual_override">
                        <span class="checkbox-text">Manual override</span>
                    </label>
                    <div id="score-bias-auto" class="scoring-readonly-value">Auto bias: No data</div>
                </div>
                <div class="form-group">
                    <label>Structure <span class="help-icon" data-tooltip="UkĹ‚ad swingĂłw na D1: HH/HL (bull), LL/LH (bear), Mixed/Range (ostroĹĽnie).">?</span></label>
                    <div class="checkbox-group scoring-option-grid">
                        <label class="checkbox-label"><input type="radio" name="score_spy_structure" value="hh_hl"><span class="checkbox-text">HH/HL</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_spy_structure" value="ll_lh"><span class="checkbox-text">LL/LH</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_spy_structure" value="mixed"><span class="checkbox-text">Mixed</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_spy_structure" value="range"><span class="checkbox-text">Range</span></label>
                    </div>
                </div>
                <div class="form-group">
                    <label>Trend Strength <span class="help-icon" data-tooltip="PoĹ‚oĹĽenie vs 20EMA/50MA/200SMA jako filtr reĹĽimu: powyĹĽej = long-friendly, poniĹĽej = short-friendly, wokĂłĹ‚ = ostroĹĽnoĹ›Ä‡.">?</span></label>
                    <div class="checkbox-group scoring-option-grid">
                        <label class="checkbox-label"><input type="radio" name="score_spy_trend_strength" value="above_key_mas"><span class="checkbox-text">Above key MAs</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_spy_trend_strength" value="below_key_mas"><span class="checkbox-text">Below key MAs</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_spy_trend_strength" value="chop_around_mas"><span class="checkbox-text">Chop around MAs</span></label>
                    </div>
                </div>
                <div class="form-group">
                    <label>VWAP (optional) <span class="help-icon" data-tooltip="Na 1D to dodatkowy kontekst, nie filar decyzji kierunkowej.">?</span></label>
                    <div class="checkbox-group scoring-option-grid">
                        <label class="checkbox-label"><input type="radio" name="score_spy_vwap" value="above"><span class="checkbox-text">Above</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_spy_vwap" value="below"><span class="checkbox-text">Below</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_spy_vwap" value="na"><span class="checkbox-text">N/A</span></label>
                    </div>
                </div>
                <div class="form-group">
                    <label>Momentum Condition (1D) <span class="help-icon" data-tooltip="Expanding: range roĹ›nie i zamkniÄ™cia wspierajÄ… kierunek; Stable: trend trwa bez przyspieszenia; Diverging: cena idzie dalej, ale momentum nie potwierdza; Exhausted: po dĹ‚ugim ruchu impet gaĹ›nie i roĹ›nie ryzyko mean reversion.">?</span></label>
                    <div class="checkbox-group scoring-option-grid">
                        <label class="checkbox-label"><input type="radio" name="score_spy_momentum_condition" value="expanding"><span class="checkbox-text">Expanding</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_spy_momentum_condition" value="stable"><span class="checkbox-text">Stable</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_spy_momentum_condition" value="diverging"><span class="checkbox-text">Diverging</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_spy_momentum_condition" value="exhausted"><span class="checkbox-text">Exhausted</span></label>
                    </div>
                </div>
            </div>
            <div id="score-inconsistency" class="scoring-guardrail"></div>
        </div>

        <div class="analysis-subsection score-section-b">
            <h4>B. Location & Blocks</h4>
            <div class="scoring-stage-grid">
                <div class="form-group">
                    <label>Location <span class="help-icon" data-tooltip="Gdzie jest cena wzglÄ™dem leveli: edge (wsparcie/opĂłr) daje plan; Ĺ›rodek range = brak przewagi.">?</span></label>
                    <div class="checkbox-group scoring-option-grid">
                        <label class="checkbox-label"><input type="radio" name="score_spy_location" value="at_support"><span class="checkbox-text">At Support</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_spy_location" value="at_resistance"><span class="checkbox-text">At Resistance</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_spy_location" value="middle_of_range"><span class="checkbox-text">Middle of Range</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_spy_location" value="breakout_attempt"><span class="checkbox-text">Breakout Attempt</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_spy_location" value="breakdown_attempt"><span class="checkbox-text">Breakdown Attempt</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_spy_location" value="post_break_retest"><span class="checkbox-text">Post-break Retest</span></label>
                    </div>
                </div>
                <div class="form-group">
                    <label>Support status <span class="help-icon" data-tooltip="Stan poziomu: Holding / Broken / Reclaimed / Rejecting / Not tested.">?</span></label>
                    <div class="checkbox-group scoring-option-grid">
                        <label class="checkbox-label"><input type="radio" name="score_spy_support_status" value="holding"><span class="checkbox-text">Holding</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_spy_support_status" value="broken"><span class="checkbox-text">Broken</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_spy_support_status" value="reclaimed"><span class="checkbox-text">Reclaimed</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_spy_support_status" value="rejecting"><span class="checkbox-text">Rejecting</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_spy_support_status" value="not_tested"><span class="checkbox-text">Not tested</span></label>
                    </div>
                </div>
                <div class="form-group">
                    <label>Resistance status <span class="help-icon" data-tooltip="Stan poziomu: Holding / Broken / Reclaimed / Rejecting / Not tested.">?</span></label>
                    <div class="checkbox-group scoring-option-grid">
                        <label class="checkbox-label"><input type="radio" name="score_spy_resistance_status" value="holding"><span class="checkbox-text">Holding</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_spy_resistance_status" value="broken"><span class="checkbox-text">Broken</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_spy_resistance_status" value="reclaimed"><span class="checkbox-text">Reclaimed</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_spy_resistance_status" value="rejecting"><span class="checkbox-text">Rejecting</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_spy_resistance_status" value="not_tested"><span class="checkbox-text">Not tested</span></label>
                    </div>
                </div>
                <div class="form-group score-b-room-to-move">
                    <label>Room to Move <span class="help-icon" data-tooltip="Ile miejsca jest do kolejnego poziomu. MaĹ‚e room = sĹ‚aby R/R dla swing.">?</span></label>
                    <div class="checkbox-group scoring-option-grid">
                        <label class="checkbox-label"><input type="radio" name="score_spy_room_to_move" value="large"><span class="checkbox-text">Large</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_spy_room_to_move" value="medium"><span class="checkbox-text">Medium</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_spy_room_to_move" value="limited"><span class="checkbox-text">Limited</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_spy_room_to_move" value="none"><span class="checkbox-text">None</span></label>
                    </div>
                    <div id="score-room-effective" class="scoring-readonly-value">Auto room: No data | Effective: No data</div>
                </div>
                <div class="form-group score-b-manual-values">
                    <div class="timeframe-row-2cols">
                        <div>
                            <label>Close</label>
                            <input name="score_spy_manual_close" type="text" placeholder="">
                        </div>
                        <div>
                            <label>ATR (14)</label>
                            <input name="score_spy_manual_atr" type="text" placeholder="">
                        </div>
                    </div>
                </div>
                <div class="form-group score-b-key-levels" style="grid-column: 1 / -1;">
                    <label>Key Levels <span class="help-icon" data-tooltip="Major swing levels (1D/weekly): PDH/PDL, PWH/PWL, swing high/low, 20/50/200. Nie uzywaj intraday mikro-poziomow. Te poziomy definiuja room i invalidation.">?</span></label>
                    <div style="display:grid; grid-template-columns: repeat(4, minmax(0, 1fr)); gap:8px;">
                        <div>
                            <label>Support (Legacy)</label>
                            <input id="score_spy_key_support" name="score_spy_key_support" type="text" placeholder="">
                            <label style="margin-top:6px;">Resistance (Legacy)</label>
                            <input id="score_spy_key_resistance" name="score_spy_key_resistance" type="text" placeholder="" style="margin-top:6px;">
                        </div>
                        <div>
                            <label>MajorSwingHigh 1D</label>
                            <input name="score_spy_swing_high" type="text" placeholder="">
                            <label style="margin-top:6px;">MajorSwingLow 1D</label>
                            <input name="score_spy_swing_low" type="text" placeholder="" style="margin-top:6px;">
                        </div>
                        <div>
                            <label>PWH</label>
                            <input name="score_spy_pwh" type="text" placeholder="">
                            <label style="margin-top:6px;">PWL</label>
                            <input name="score_spy_pwl" type="text" placeholder="" style="margin-top:6px;">
                        </div>
                        <div>
                            <label>SMA200</label>
                            <input name="score_spy_sma200" type="text" placeholder="">
                        </div>
                    </div>
                    <div style="display:grid; grid-template-columns: repeat(4, minmax(0, 1fr)); gap:8px; margin-top:8px;">
                        <div>
                            <label>DCH20</label>
                            <input name="score_spy_dch20" type="text" placeholder="">
                            <label style="margin-top:6px;">DCL20</label>
                            <input name="score_spy_dcl20" type="text" placeholder="" style="margin-top:6px;">
                        </div>
                        <div>
                            <label>DCH55</label>
                            <input name="score_spy_dch55" type="text" placeholder="">
                            <label>DCL55</label>
                            <input name="score_spy_dcl55" type="text" placeholder="" style="margin-top:6px;">
                        </div>
                        <div>
                            <label>Room Barrier</label>
                            <select name="score_spy_room_barrier_choice">
                                <option value="auto">Auto</option>
                                <option value="swing_high">Swing High</option>
                                <option value="swing_low">Swing Low</option>
                                <option value="pwh">PWH</option>
                                <option value="pwl">PWL</option>
                                <option value="dch20">DCH20</option>
                                <option value="dcl20">DCL20</option>
                                <option value="dch55">DCH55</option>
                                <option value="dcl55">DCL55</option>
                                <option value="sma200">SMA200</option>
                            </select>
                        </div>
                        <div>
                            <label>Noise ATR</label>
                            <input name="score_spy_room_noise_atr" type="text" placeholder="" value="0.30" disabled>
                            <label style="margin-top:6px;">Room Min ATR</label>
                            <input name="score_spy_room_min_atr" type="text" placeholder="" value="0.80" disabled style="margin-top:6px;">
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="analysis-subsection">
            <h4>C. Risk Conditions</h4>
            <div class="scoring-stage-grid">
                <div class="form-group">
                    <label>VIX Level <span class="help-icon" data-tooltip="VIX wysoki i rosnÄ…cy = wiÄ™ksze ryzyko whipsaw; niski i spadajÄ…cy = stabilniej.">?</span></label>
                    <div class="checkbox-group scoring-option-grid">
                        <label class="checkbox-label"><input type="radio" name="score_spy_vix_level" value="lt20"><span class="checkbox-text">&lt;20</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_spy_vix_level" value="20_25"><span class="checkbox-text">20-25</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_spy_vix_level" value="gt25"><span class="checkbox-text">&gt;25</span></label>
                    </div>
                </div>
                <div class="form-group">
                    <label>VIX Trend <span class="help-icon" data-tooltip="Rising VIX zwykle pogarsza warunki dla spokojnych swingĂłw; falling VIX sprzyja stabilniejszym trendom.">?</span></label>
                    <div class="checkbox-group scoring-option-grid">
                        <label class="checkbox-label"><input type="radio" name="score_spy_vix_trend" value="rising"><span class="checkbox-text">Rising</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_spy_vix_trend" value="falling"><span class="checkbox-text">Falling</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_spy_vix_trend" value="flat"><span class="checkbox-text">Flat</span></label>
                    </div>
                </div>
                <div class="form-group">
                    <label>ATR% Environment <span class="help-icon" data-tooltip="ATR% = typowa dzienna zmiennoĹ›Ä‡. Urealnia stop i targety.">?</span></label>
                    <div class="checkbox-group scoring-option-grid">
                        <label class="checkbox-label"><input type="radio" name="score_spy_atr_env" value="low"><span class="checkbox-text">Low</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_spy_atr_env" value="normal"><span class="checkbox-text">Normal</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_spy_atr_env" value="high"><span class="checkbox-text">High</span></label>
                    </div>
                </div>
                <div class="form-group">
                    <label>Breadth <span class="help-icon" data-tooltip="Breadth = czy rynek niesie wiele spĂłĹ‚ek czy tylko kilka. SĹ‚aby breadth = wiÄ™ksze ryzyko faĹ‚szywych ruchĂłw.">?</span></label>
                    <div class="checkbox-group scoring-option-grid">
                        <label class="checkbox-label"><input type="radio" name="score_spy_breadth" value="strong"><span class="checkbox-text">Strong</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_spy_breadth" value="neutral"><span class="checkbox-text">Neutral</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_spy_breadth" value="weak"><span class="checkbox-text">Weak</span></label>
                    </div>
                </div>
                <div class="form-group">
                    <label>QQQ vs 200SMA</label>
                    <div class="checkbox-group scoring-option-grid">
                        <label class="checkbox-label"><input type="radio" name="score_qqq_200_state" value="above"><span class="checkbox-text">Above</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_qqq_200_state" value="below"><span class="checkbox-text">Below</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_qqq_200_state" value="na"><span class="checkbox-text">N/A</span></label>
                    </div>
                </div>
                <div class="form-group">
                    <label>Event Risk <span class="help-icon" data-tooltip="Dni eventowe zwiÄ™kszajÄ… ryzyko skokĂłw i odwrĂłceĹ„. Swing options: mniejszy size albo czekanie po evencie.">?</span></label>
                    <div class="checkbox-group scoring-option-grid scoring-option-grid-2">
                        <label class="checkbox-label"><input type="checkbox" name="score_spy_event_cpi"><span class="checkbox-text">CPI</span></label>
                        <label class="checkbox-label"><input type="checkbox" name="score_spy_event_fomc"><span class="checkbox-text">FOMC</span></label>
                        <label class="checkbox-label"><input type="checkbox" name="score_spy_event_nfp"><span class="checkbox-text">NFP</span></label>
                        <label class="checkbox-label"><input type="checkbox" name="score_spy_event_opex"><span class="checkbox-text">OPEX</span></label>
                        <label class="checkbox-label"><input type="checkbox" name="score_spy_event_earnings_heavy"><span class="checkbox-text">Earnings-heavy day</span></label>
                    </div>
                </div>
            </div>
        </div>

        <div class="analysis-subsection">
            <h4>Output</h4>
            <div class="scoring-stage-grid">
                <div class="form-group">
                    <label>Market Permission (auto)</label>
                    <div id="score-market-permission-box" class="scoring-readonly-value">No data</div>
                </div>
                <div class="form-group">
                    <label>Risk State (auto)</label>
                    <div id="score-risk-state-box" class="scoring-readonly-value">No data</div>
                </div>
                <div class="form-group">
                    <label>Size Modifier (auto)</label>
                    <div id="score-size-modifier-box" class="scoring-readonly-value">-</div>
                </div>
                <div class="form-group">
                    <label>Breakdown</label>
                    <div id="score-breakdown" class="scoring-readonly-value">A: 0/40 | B: 0/35 | C: 0/25</div>
                </div>
                <div class="form-group">
                    <label>Edge Type</label>
                    <div id="score-edge-type-box" class="scoring-readonly-value">No data</div>
                </div>
                <div class="form-group" style="grid-column: span 2;">
                    <label>Summary</label>
                    <div id="score-summary" class="scoring-readonly-value">Fill fields to evaluate market gatekeeper.</div>
                </div>
            </div>
        </div>
    </div>

    <div class="analysis-section">
        <div class="scoring-header-row">
            <h3>Ticker (1D) - Direction &amp; Context</h3>
            <div class="scoring-header-summary">
                <div><strong>Ticker Score:</strong> <span id="score-stk1d-score-head">No data</span></div>
                <div><strong>Permission:</strong> <span id="score-stk1d-permission-head">No data</span></div>
            </div>
        </div>
        <div class="analysis-subsection">
            <h4>Ticker (1D) - Direction &amp; Context</h4>
            <div class="scoring-stage-grid stock1d-layout">
                <div class="form-group">
                    <label for="score_stk1d_ticker">Ticker <span class="help-icon" data-tooltip="Symbol akcji analizowanej na interwale 1D.">?</span></label>
                    <input id="score_stk1d_ticker" name="score_stk1d_ticker" type="text" placeholder="NVDA">
                </div>
                <div class="form-group">
                    <label>Market Regime <span class="help-icon" data-tooltip="Trend = HH/HL lub LL/LH + nachylone MA. Range = overlap Ĺ›wiec + pĹ‚askie MA. Volatile = duĹĽe Ĺ›wiece/ATR% wysokie, czÄ™ste zwroty.">?</span></label>
                    <div class="checkbox-group scoring-option-grid">
                        <label class="checkbox-label"><input type="radio" name="score_stk1d_regime" value="trend_up"><span class="checkbox-text">Trend Up</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk1d_regime" value="trend_down"><span class="checkbox-text">Trend Down</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk1d_regime" value="range"><span class="checkbox-text">Range</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk1d_regime" value="volatile"><span class="checkbox-text">Volatile</span></label>
                    </div>
                </div>
                <div class="form-group">
                    <label>Bias <span class="help-icon" data-tooltip="Preferowany kierunek zagraĹ„ na tickerze. DomyĹ›lnie liczony automatycznie z Regime + Structure + Trend Strength + Momentum.">?</span></label>
                    <div class="checkbox-group scoring-option-grid">
                        <label class="checkbox-label"><input type="radio" name="score_stk1d_bias" value="bullish"><span class="checkbox-text">Bullish</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk1d_bias" value="bearish"><span class="checkbox-text">Bearish</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk1d_bias" value="neutral"><span class="checkbox-text">Neutral</span></label>
                    </div>
                    <label class="checkbox-label" style="margin-top:8px;">
                        <input type="checkbox" name="score_stk1d_bias_manual_override">
                        <span class="checkbox-text">Manual override</span>
                    </label>
                    <div id="score-stk1d-bias-auto" class="scoring-readonly-value">Auto bias: No data</div>
                </div>
                <div class="form-group">
                    <label>Structure <span class="help-icon" data-tooltip="UkĹ‚ad swingĂłw na D1: HH/HL (bull), LL/LH (bear), Mixed/Range (ostroĹĽnie).">?</span></label>
                    <div class="checkbox-group scoring-option-grid">
                        <label class="checkbox-label"><input type="radio" name="score_stk1d_structure" value="hh_hl"><span class="checkbox-text">HH/HL</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk1d_structure" value="ll_lh"><span class="checkbox-text">LL/LH</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk1d_structure" value="mixed"><span class="checkbox-text">Mixed</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk1d_structure" value="range"><span class="checkbox-text">Range</span></label>
                    </div>
                </div>
                <div class="form-group">
                    <label>Trend Strength <span class="help-icon" data-tooltip="PoĹ‚oĹĽenie vs 20EMA/50MA/200SMA: powyĹĽej = long-friendly, poniĹĽej = short-friendly, wokĂłĹ‚ = chop/ostroĹĽnoĹ›Ä‡.">?</span></label>
                    <div class="checkbox-group scoring-option-grid">
                        <label class="checkbox-label"><input type="radio" name="score_stk1d_trend_strength" value="above_key_mas"><span class="checkbox-text">Above key MAs</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk1d_trend_strength" value="below_key_mas"><span class="checkbox-text">Below key MAs</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk1d_trend_strength" value="chop_around_mas"><span class="checkbox-text">Chop around MAs</span></label>
                    </div>
                </div>
                <div class="form-group">
                    <label>VWAP (optional) <span class="help-icon" data-tooltip="Na 1D to dodatkowy kontekst, nie filar decyzji kierunkowej.">?</span></label>
                    <div class="checkbox-group scoring-option-grid">
                        <label class="checkbox-label"><input type="radio" name="score_stk1d_vwap" value="above"><span class="checkbox-text">Above</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk1d_vwap" value="below"><span class="checkbox-text">Below</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk1d_vwap" value="na"><span class="checkbox-text">N/A</span></label>
                    </div>
                </div>
                <div class="form-group">
                    <label>Momentum Condition (1D) <span class="help-icon" data-tooltip="Expanding = impet roĹ›nie; Stable = trend trwa; Diverging = impet nie potwierdza ceny; Exhausted = roĹ›nie ryzyko cofniÄ™cia.">?</span></label>
                    <div class="checkbox-group scoring-option-grid">
                        <label class="checkbox-label"><input type="radio" name="score_stk1d_momentum" value="expanding"><span class="checkbox-text">Expanding</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk1d_momentum" value="stable"><span class="checkbox-text">Stable</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk1d_momentum" value="diverging"><span class="checkbox-text">Diverging</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk1d_momentum" value="exhausted"><span class="checkbox-text">Exhausted</span></label>
                    </div>
                </div>
                <div class="form-group">
                    <label>Market Alignment (vs SPY) <span class="help-icon" data-tooltip="Aligned/Mixed/Contra: zgodnoĹ›Ä‡ tickera z kierunkiem SPY.">?</span></label>
                    <div class="checkbox-group scoring-option-grid">
                        <label class="checkbox-label"><input type="radio" name="score_stk1d_alignment" value="aligned"><span class="checkbox-text">Aligned</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk1d_alignment" value="mixed"><span class="checkbox-text">Mixed</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk1d_alignment" value="contra"><span class="checkbox-text">Contra</span></label>
                    </div>
                </div>
                <div class="form-group">
                    <label>RS state vs SPY <span class="help-icon" data-tooltip="Relative strength wzglÄ™dem SPY: Strong/Neutral/Weak.">?</span></label>
                    <div class="checkbox-group scoring-option-grid">
                        <label class="checkbox-label"><input type="radio" name="score_stk1d_rs_state" value="strong"><span class="checkbox-text">Strong</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk1d_rs_state" value="neutral"><span class="checkbox-text">Neutral</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk1d_rs_state" value="weak"><span class="checkbox-text">Weak</span></label>
                    </div>
                </div>
                <div class="form-group">
                    <label>RS trend <span class="help-icon" data-tooltip="Kierunek RS vs SPY: rising/flat/falling.">?</span></label>
                    <div class="checkbox-group scoring-option-grid">
                        <label class="checkbox-label"><input type="radio" name="score_stk1d_rs_trend" value="rising"><span class="checkbox-text">Rising</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk1d_rs_trend" value="flat"><span class="checkbox-text">Flat</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk1d_rs_trend" value="falling"><span class="checkbox-text">Falling</span></label>
                    </div>
                </div>
                <div class="form-group stk1d-manual-values">
                    <div class="timeframe-row-2cols">
                        <div>
                            <label>Close</label>
                            <input name="score_stk1d_close" type="text" placeholder="">
                        </div>
                        <div>
                            <label>ATR (14)</label>
                            <input name="score_stk1d_atr" type="text" placeholder="">
                        </div>
                    </div>
                </div>
                <div class="form-group stk1d-key-levels">
                    <label>Key Levels <span class="help-icon" data-tooltip="Major swing levels (1D/weekly): PDH/PDL, PWH/PWL, swing high/low, 20/50/200. Nie uzywaj intraday mikro-poziomow. Te poziomy definiuja room i invalidation.">?</span></label>
                    <div class="timeframe-row-2cols">
                        <input name="score_stk1d_support" type="text" placeholder="Support (legacy)">
                        <input name="score_stk1d_resistance" type="text" placeholder="Resistance (legacy)">
                    </div>
                    <div style="display:grid; grid-template-columns: repeat(2, minmax(0, 1fr)); gap:8px; margin-top:8px;">
                        <div>
                            <label>MajorSwingHigh 1D</label>
                            <input name="score_stk1d_swing_high" type="text" placeholder="">
                            <label style="margin-top:6px;">MajorSwingLow 1D</label>
                            <input name="score_stk1d_swing_low" type="text" placeholder="" style="margin-top:6px;">
                        </div>
                        <div>
                            <label>SMA200</label>
                            <input name="score_stk1d_sma200" type="text" placeholder="">
                        </div>
                    </div>
                    <div style="display:grid; grid-template-columns: repeat(3, minmax(0, 1fr)); gap:8px; margin-top:8px;">
                        <input name="score_stk1d_pwh" type="text" placeholder="PWH">
                        <input name="score_stk1d_pwl" type="text" placeholder="PWL">
                        <input name="score_stk1d_dch20" type="text" placeholder="DCH20">
                    </div>
                    <div style="display:grid; grid-template-columns: repeat(3, minmax(0, 1fr)); gap:8px; margin-top:8px;">
                        <input name="score_stk1d_dcl20" type="text" placeholder="DCL20">
                        <select name="score_stk1d_room_barrier_choice">
                            <option value="auto">Room Barrier: Auto</option>
                            <option value="swing_high">Swing High</option>
                            <option value="swing_low">Swing Low</option>
                            <option value="pwh">PWH</option>
                            <option value="pwl">PWL</option>
                            <option value="dch20">DCH20</option>
                            <option value="dcl20">DCL20</option>
                            <option value="sma200">SMA200</option>
                        </select>
                        <input name="score_stk1d_room_noise_atr" type="text" placeholder="Noise ATR (0.30)" value="0.30" disabled>
                    </div>
                    <div style="display:grid; grid-template-columns: repeat(3, minmax(0, 1fr)); gap:8px; margin-top:8px;">
                        <input name="score_stk1d_room_min_atr" type="text" placeholder="Room Min ATR (0.60)" value="0.60" disabled>
                    </div>
                </div>
                <div class="form-group stk1d-room-to-move">
                    <label>Room to Move <span class="help-icon" data-tooltip="Ile miejsca jest do kolejnego poziomu. Male room = slaby R/R dla swing.">?</span></label>
                    <div class="checkbox-group scoring-option-grid">
                        <label class="checkbox-label"><input type="radio" name="score_stk1d_room_to_move" value="large"><span class="checkbox-text">Large</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk1d_room_to_move" value="medium"><span class="checkbox-text">Medium</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk1d_room_to_move" value="limited"><span class="checkbox-text">Limited</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk1d_room_to_move" value="none"><span class="checkbox-text">None</span></label>
                    </div>
                    <div id="score-stk1d-room-effective" class="scoring-readonly-value">Auto room: No data | Effective: No data</div>
                </div>
                <div class="analysis-subsection" style="grid-column: 1 / -1;">
                    <h4>Output</h4>
                </div>
                <div class="form-group stk1d-permission-box">
                    <label>Ticker Permission (auto) <span class="help-icon" data-tooltip="Automatyczna decyzja dla tickera: Allowed / Reduced / No-trade.">?</span></label>
                    <div id="score-stk1d-permission" class="scoring-readonly-value">No data</div>
                </div>
                <div class="form-group stk1d-invalidation-box">
                    <label>Invalidation tomorrow (auto) <span class="help-icon" data-tooltip="Warunek uniewaĹĽnienia setupu na kolejnej sesji (kontekst 1D).">?</span></label>
                    <div id="score-stk1d-invalidation" class="scoring-readonly-value">No data</div>
                </div>
            </div>
        </div>
    </div>

        <div class="analysis-section">
        <div class="scoring-header-row">
            <h3>Ticker (4H) - Structure &amp; Planning</h3>
            <div class="scoring-header-summary">
                <div><strong>4H Score:</strong> <span id="score-stk4h-score-head">No data</span></div>
                <div><strong>Grade:</strong> <span id="score-stk4h-grade-head">No data</span></div>
                <div><strong>Status:</strong> <span id="score-stk4h-status-head">No data</span></div>
            </div>
        </div>
        <div class="analysis-subsection">
            <div class="scoring-stage-grid">
                <div class="form-group">
                    <label>Bias vs 1D <span class="help-icon" data-tooltip="Relacja kierunku 4H do 1D. In direction of 1D = najbezpieczniej, Counter-trend = przeciw 1D, Neutral = brak zgodnoĹ›ci/chop.">?</span></label>
                    <div class="checkbox-group scoring-option-grid">
                        <label class="checkbox-label"><input type="radio" name="score_stk4h_bias_vs_1d_hint" value="in_direction_1d"><span class="checkbox-text">In direction of 1D</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk4h_bias_vs_1d_hint" value="counter_trend"><span class="checkbox-text">Counter-trend</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk4h_bias_vs_1d_hint" value="neutral"><span class="checkbox-text">Neutral</span></label>
                    </div>
                </div>
                <div class="form-group">
                    <label>Bias 1D <span class="help-icon" data-tooltip="Automatyczny kierunek na 1D. To kierunek nadrzÄ™dny dla planu 4H.">?</span></label>
                    <div class="checkbox-group scoring-option-grid">
                        <label class="checkbox-label"><input type="radio" name="score_stk4h_bias_1d_auto" value="bullish"><span class="checkbox-text">Bullish</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk4h_bias_1d_auto" value="bearish"><span class="checkbox-text">Bearish</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk4h_bias_1d_auto" value="neutral"><span class="checkbox-text">Neutral</span></label>
                    </div>
                </div>
                <div class="form-group">
                    <label>Bias 4H <span class="help-icon" data-tooltip="Automatyczny kierunek wykonawczy na 4H (bullish/bearish/neutral).">?</span></label>
                    <div class="checkbox-group scoring-option-grid">
                        <label class="checkbox-label"><input type="radio" name="score_stk4h_bias_4h_auto" value="bullish"><span class="checkbox-text">Bullish</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk4h_bias_4h_auto" value="bearish"><span class="checkbox-text">Bearish</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk4h_bias_4h_auto" value="neutral"><span class="checkbox-text">Neutral</span></label>
                    </div>
                </div>
                <div class="form-group">
                    <label>4H Structure <span class="help-icon" data-tooltip="Typ struktury 4H: HH/HL, LL/LH, Compression, Range, Transition. Kluczowe dla wyboru setupu.">?</span></label>
                    <div class="checkbox-group scoring-option-grid">
                        <label class="checkbox-label"><input type="radio" name="score_stk4h_structure_auto" value="hh_hl"><span class="checkbox-text">HH/HL</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk4h_structure_auto" value="ll_lh"><span class="checkbox-text">LL/LH</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk4h_structure_auto" value="compression"><span class="checkbox-text">Compression</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk4h_structure_auto" value="range"><span class="checkbox-text">Range</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk4h_structure_auto" value="transition"><span class="checkbox-text">Transition</span></label>
                    </div>
                </div>
                <div class="form-group">
                    <label>Trend Strength <span class="help-icon" data-tooltip="Pozycja ceny wzglÄ™dem EMA20/SMA50/SMA200: Above/Below/Chop around MAs.">?</span></label>
                    <div class="checkbox-group scoring-option-grid">
                        <label class="checkbox-label"><input type="radio" name="score_stk4h_trend_strength_auto" value="above_key_mas"><span class="checkbox-text">Above key MAs</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk4h_trend_strength_auto" value="below_key_mas"><span class="checkbox-text">Below key MAs</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk4h_trend_strength_auto" value="chop_around_mas"><span class="checkbox-text">Chop around MAs</span></label>
                    </div>
                </div>
                <div class="form-group">
                    <label>Trend Quality <span class="help-icon" data-tooltip="JakoĹ›Ä‡ ruchu: Clean trend, Overlapping/messy lub Exhausted. Messy wymaga twardszego potwierdzenia.">?</span></label>
                    <div class="checkbox-group scoring-option-grid">
                        <label class="checkbox-label"><input type="radio" name="score_stk4h_trend_quality_auto" value="clean_trend"><span class="checkbox-text">Clean trend</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk4h_trend_quality_auto" value="overlapping_messy"><span class="checkbox-text">Overlapping / messy</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk4h_trend_quality_auto" value="exhausted"><span class="checkbox-text">Exhausted</span></label>
                    </div>
                </div>
                <div class="form-group">
                    <label>Regime <span class="help-icon" data-tooltip="Ĺšrodowisko 4H: Trend Up/Trend Down/Range/Volatile. Pomaga dobraÄ‡ typ setupu.">?</span></label>
                    <div class="checkbox-group scoring-option-grid">
                        <label class="checkbox-label"><input type="radio" name="score_stk4h_regime_auto" value="trend_up"><span class="checkbox-text">Trend Up</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk4h_regime_auto" value="trend_down"><span class="checkbox-text">Trend Down</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk4h_regime_auto" value="range"><span class="checkbox-text">Range</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk4h_regime_auto" value="volatile"><span class="checkbox-text">Volatile</span></label>
                    </div>
                </div>
                <div class="form-group">
                    <label>VWAP state <span class="help-icon" data-tooltip="Pozycja ceny wzglÄ™dem VWAP (kontekst pomocniczy): Above/Below/Around/N/A.">?</span></label>
                    <div class="checkbox-group scoring-option-grid">
                        <label class="checkbox-label"><input type="radio" name="score_stk4h_vwap_state_auto" value="above"><span class="checkbox-text">Above</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk4h_vwap_state_auto" value="below"><span class="checkbox-text">Below</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk4h_vwap_state_auto" value="around"><span class="checkbox-text">Around</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk4h_vwap_state_auto" value="na"><span class="checkbox-text">N/A</span></label>
                    </div>
                </div>
                <div class="form-group">
                    <label>Location <span class="help-icon" data-tooltip="Pozycja ceny na strukturze: przy wsparciu/oporze 4H, przy poziomie HTF (1D) lub w Ĺ›rodku struktury.">?</span></label>
                    <div class="checkbox-group scoring-option-grid">
                        <label class="checkbox-label"><input type="radio" name="score_stk4h_location_hint" value="at_4h_support"><span class="checkbox-text">At 4H support</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk4h_location_hint" value="at_4h_resistance"><span class="checkbox-text">At 4H resistance</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk4h_location_hint" value="at_htf_level"><span class="checkbox-text">At HTF level (1D)</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk4h_location_hint" value="middle_of_structure"><span class="checkbox-text">Middle of structure</span></label>
                    </div>
                </div>
                <div class="form-group">
                    <label>Liquidity <span class="help-icon" data-tooltip="SygnaĹ‚y pĹ‚ynnoĹ›ci/puĹ‚apki: sweep low/high, inside bar compression lub brak sygnaĹ‚u.">?</span></label>
                    <div class="checkbox-group scoring-option-grid">
                        <label class="checkbox-label"><input type="radio" name="score_stk4h_liquidity_hint" value="sweep_low"><span class="checkbox-text">Sweep of low</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk4h_liquidity_hint" value="sweep_high"><span class="checkbox-text">Sweep of high</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk4h_liquidity_hint" value="inside_bar_compression"><span class="checkbox-text">Inside bar compression</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk4h_liquidity_hint" value="none"><span class="checkbox-text">None</span></label>
                    </div>
                </div>
                <div class="form-group" style="grid-column: 1 / -1;">
                    <label>Auto Values <span class="help-icon" data-tooltip="WartoĹ›ci referencyjne z Pine (Close, ATR, Support/Resistance, PWH/PWL) uĹĽywane do RR, room i planu ryzyka.">?</span></label>
                    <div class="timeframe-row-3cols">
                        <div>
                            <label>Close <span class="help-icon" data-tooltip="Aktualna cena zamkniÄ™cia 4H.">?</span></label>
                            <input name="score_stk4h_close" type="text" placeholder="Close">
                            <label style="margin-top:6px;">ATR(14) <span class="help-icon" data-tooltip="ATR 14 na 4H, baza do room i buforĂłw stopa.">?</span></label>
                            <input name="score_stk4h_atr14" type="text" placeholder="ATR(14)" style="margin-top:6px;">
                        </div>
                        <div>
                            <label>Support (Legacy)</label>
                            <input name="score_stk4h_support_auto" type="text" placeholder="Legacy support (fallback)">
                            <label style="margin-top:6px;">Resistance (Legacy)</label>
                            <input name="score_stk4h_resistance_auto" type="text" placeholder="Legacy resistance (fallback)" style="margin-top:6px;">
                        </div>
                        <div>
                            <label>PWH <span class="help-icon" data-tooltip="Previous Week High (HTF bariera).">?</span></label>
                            <input name="score_stk4h_pwh" type="text" placeholder="PWH">
                            <label style="margin-top:6px;">PWL <span class="help-icon" data-tooltip="Previous Week Low (HTF bariera).">?</span></label>
                            <input name="score_stk4h_pwl" type="text" placeholder="PWL" style="margin-top:6px;">
                        </div>
                    </div>
                    <div style="display:grid; grid-template-columns: repeat(3, minmax(0, 1fr)); gap:10px; margin-top:8px;">
                        <div>
                            <label>Swing High 4H</label>
                            <input name="score_stk4h_swing_high" type="text" placeholder="Swing High 4H">
                            <label style="margin-top:6px;">Swing Low 4H</label>
                            <input name="score_stk4h_swing_low" type="text" placeholder="Swing Low 4H" style="margin-top:6px;">
                        </div>
                        <div>
                            <label>DCH20</label>
                            <input name="score_stk4h_dch20" type="text" placeholder="DCH20">
                        </div>
                        <div>
                            <label>DCL20</label>
                            <input name="score_stk4h_dcl20" type="text" placeholder="DCL20">
                        </div>
                    </div>
                    <div style="display:grid; grid-template-columns: repeat(3, minmax(0, 1fr)); gap:10px; margin-top:8px;">
                        <div>
                            <label>Range High</label>
                            <input name="score_stk4h_range_high" type="text" placeholder="Range High">
                            <label style="margin-top:6px;">Range Low</label>
                            <input name="score_stk4h_range_low" type="text" placeholder="Range Low" style="margin-top:6px;">
                        </div>
                        <div>
                            <label>Room Barrier</label>
                            <select name="score_stk4h_room_barrier_choice">
                                <option value="auto">Auto (recommended)</option>
                                <option value="swing_high">Swing High 4H</option>
                                <option value="swing_low">Swing Low 4H</option>
                                <option value="pwh">PWH</option>
                                <option value="pwl">PWL</option>
                                <option value="dch20">DCH20</option>
                                <option value="dcl20">DCL20</option>
                                <option value="range_high">Range High</option>
                                <option value="range_low">Range Low</option>
                            </select>
                        </div>
                        <div>
                            <label>Noise Filter (ATR)</label>
                            <input name="score_stk4h_room_noise_atr" type="text" placeholder="0.30" value="0.30">
                        </div>
                    </div>
                    <div style="display:grid; grid-template-columns: repeat(4, minmax(0, 1fr)); gap:10px; margin-top:8px;">
                        <div>
                            <label>Room Min (ATR)</label>
                            <input name="score_stk4h_room_min_atr" type="text" placeholder="0.80" value="0.80">
                        </div>
                    </div>
                </div>
                <div class="analysis-subsection" style="grid-column: 1 / -1;"></div>
                <div class="form-group">
                    <label>Setup Type <span class="help-icon" data-tooltip="Typ scenariusza 4H (pullback/breakout/range/breakdown/reversal). Definiuje kierunek planu i logikÄ™ invalidacji.">?</span></label>
                    <div class="checkbox-group scoring-option-grid">
                        <label class="checkbox-label"><input type="radio" name="score_stk4h_setup_type" value="pullback_continuation"><span class="checkbox-text">Pullback continuation</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk4h_setup_type" value="breakout_continuation"><span class="checkbox-text">Breakout continuation</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk4h_setup_type" value="range_play"><span class="checkbox-text">Range play</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk4h_setup_type" value="breakdown_continuation"><span class="checkbox-text">Breakdown continuation</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk4h_setup_type" value="reversal_attempt"><span class="checkbox-text">Reversal attempt</span></label>
                    </div>
                </div>
                <div class="form-group">
                    <label>Confirmation condition <span class="help-icon" data-tooltip="Obiektywny trigger wejĹ›cia (close above level, strong candle, reclaim, break+hold).">?</span></label>
                    <div class="checkbox-group scoring-option-grid">
                        <label class="checkbox-label"><input type="radio" name="score_stk4h_confirmation" value="close_above_level"><span class="checkbox-text">4H close above level</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk4h_confirmation" value="strong_bull_candle"><span class="checkbox-text">Strong bull candle</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk4h_confirmation" value="reclaim_level"><span class="checkbox-text">Reclaim level</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk4h_confirmation" value="break_hold"><span class="checkbox-text">Break + hold</span></label>
                    </div>
                </div>
                <div class="form-group">
                    <label>Invalidation logic <span class="help-icon" data-tooltip="Warunek uniewaĹĽnienia tezy. Powinien wynikaÄ‡ z Setup Type i Location, nie byÄ‡ losowym stopem.">?</span></label>
                    <div class="checkbox-group scoring-option-grid">
                        <label class="checkbox-label"><input type="radio" name="score_stk4h_invalidation_logic" value="below_last_hl"><span class="checkbox-text">Below last HL</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk4h_invalidation_logic" value="above_last_lh"><span class="checkbox-text">Above last LH</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk4h_invalidation_logic" value="below_4h_support"><span class="checkbox-text">Below 4H support</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk4h_invalidation_logic" value="above_4h_resistance"><span class="checkbox-text">Above 4H resistance</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk4h_invalidation_logic" value="close_back_inside_range"><span class="checkbox-text">Close back inside range</span></label>
                    </div>
                </div>
                <div class="form-group">
                    <label>Entry <span class="help-icon" data-tooltip="Poziom wejĹ›cia zgodny z triggerem (confirmation).">?</span></label>
                    <input name="score_stk4h_entry" type="text" placeholder="Entry">
                    <label style="margin-top:6px;">Stop <span class="help-icon" data-tooltip="Poziom obrony zgodny z invalidation (gdzie teza przestaje dziaĹ‚aÄ‡).">?</span></label>
                    <input name="score_stk4h_stop" type="text" placeholder="Stop" style="margin-top:6px;">
                    <label style="margin-top:6px;">Target <span class="help-icon" data-tooltip="Docelowy poziom na kolejnej logicznej barierze (S/R lub HTF).">?</span></label>
                    <input name="score_stk4h_target" type="text" placeholder="Target" style="margin-top:6px;">
                </div>
                <div class="form-group">
                    <label class="checkbox-label" style="margin-top:8px;">
                        <input type="checkbox" name="score_stk4h_plan_manual_override">
                        <span class="checkbox-text">Manual override <span class="help-icon" data-tooltip="ON: tylko rÄ™czne wartoĹ›ci. OFF: system auto-uzupeĹ‚nia brakujÄ…ce pola Part 2 heurystykÄ….">?</span></span>
                    </label>
                </div>
                <div class="analysis-subsection" style="grid-column: 1 / -1;">
                    <h4>Output</h4>
                </div>
                <div class="form-group" style="grid-column: 1 / -1;">
                    <div style="display:grid; grid-template-columns: repeat(6, minmax(0, 1fr)); gap:6px;">
                        <div id="score-stk4h-rr" class="scoring-readonly-value" title="R:R = reward/risk. <1.3 zwykle No-trade, 1.3-1.5 maks Reduced, >=1.5 akceptowalne.">R:R: No data</div>
                        <div id="score-stk4h-room" class="scoring-readonly-value" title="Room = miejsce do najbliĹĽszej bariery liczone w ATR. None zwykle obniĹĽa status.">Room: No data</div>
                        <div id="score-stk4h-plan-direction" class="scoring-readonly-value" title="Kierunek planu wyliczony z Setup Type + biasĂłw. UĹĽywany do sanity-check RR.">Plan direction: No data</div>
                        <div id="score-stk4h-plan-source" class="scoring-readonly-value" title="ĹąrĂłdĹ‚o pĂłl planu: auto/manual dla Setup, Confirmation, Invalidation i Risk levels.">Plan source: No data</div>
                        <div id="score-stk4h-breakdown" class="scoring-readonly-value" title="SkĹ‚adowe jakoĹ›ci: Structure + Setup + Risk + Penalties (0-20).">Structure: 0/8 | Setup: 0/6 | Risk: 0/6 | Penalties: 0</div>
                        <div id="score-stk4h-status" class="scoring-readonly-value" title="Finalny status i ostrzeĹĽenia hard-cap (Allowed/Reduced/No-trade).">Status: No data | Warnings: none</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="analysis-section">
        <div class="scoring-header-row">
            <h3>Ticker (15m) - Execution &amp; Timing</h3>
            <div class="scoring-header-summary">
                <div><strong>15m Score:</strong> <span id="score-stk15m-score-head">No data</span></div>
                <div><strong>Grade:</strong> <span id="score-stk15m-grade-head">No data</span></div>
                <div><strong>Status:</strong> <span id="score-stk15m-status-head">No data</span></div>
            </div>
        </div>
        <div class="analysis-subsection">
            <div class="scoring-stage-grid">
                <div class="form-group">
                    <label>Bias</label>
                    <div class="checkbox-group scoring-option-grid">
                        <label class="checkbox-label"><input type="radio" name="score_stk15m_bias" value="bullish"><span class="checkbox-text">Bullish</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk15m_bias" value="bearish"><span class="checkbox-text">Bearish</span></label>
                    </div>
                </div>
                <div class="form-group">
                    <label>Structure</label>
                    <div class="checkbox-group scoring-option-grid">
                        <label class="checkbox-label"><input type="radio" name="score_stk15m_structure" value="hh_hl"><span class="checkbox-text">HH/HL</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk15m_structure" value="ll_lh"><span class="checkbox-text">LL/LH</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk15m_structure" value="mixed"><span class="checkbox-text">Mixed</span></label>
                    </div>
                </div>
                <div class="form-group">
                    <label>VWAP</label>
                    <div class="checkbox-group scoring-option-grid">
                        <label class="checkbox-label"><input type="radio" name="score_stk15m_vwap" value="above"><span class="checkbox-text">Above</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk15m_vwap" value="middle"><span class="checkbox-text">Middle</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk15m_vwap" value="below"><span class="checkbox-text">Below</span></label>
                    </div>
                </div>
                <div class="form-group">
                    <label>Location vs 4H plan</label>
                    <div class="checkbox-group scoring-option-grid">
                        <label class="checkbox-label"><input type="radio" name="score_stk15m_location_vs_4h" value="planned_zone"><span class="checkbox-text">At planned entry zone</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk15m_location_vs_4h" value="early"><span class="checkbox-text">Early</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk15m_location_vs_4h" value="late_extended"><span class="checkbox-text">Late / extended</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk15m_location_vs_4h" value="chasing_breakout"><span class="checkbox-text">Chasing breakout</span></label>
                    </div>
                </div>
                <div class="form-group">
                    <label>Entry Type</label>
                    <div class="checkbox-group scoring-option-grid">
                        <label class="checkbox-label"><input type="radio" name="score_stk15m_entry_type" value="break_hold"><span class="checkbox-text">Break & hold</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk15m_entry_type" value="reclaim_level"><span class="checkbox-text">Reclaim level</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk15m_entry_type" value="pullback_vwap"><span class="checkbox-text">Pullback to VWAP</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk15m_entry_type" value="pullback_ema20"><span class="checkbox-text">Pullback to EMA20</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk15m_entry_type" value="first_hl"><span class="checkbox-text">First higher low (HL)</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk15m_entry_type" value="range_breakout"><span class="checkbox-text">Range breakout</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk15m_entry_type" value="sweep_reclaim"><span class="checkbox-text">Liquidity sweep reclaim</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk15m_entry_type" value="-"><span class="checkbox-text">-</span></label>
                    </div>
                </div>
                <div class="form-group">
                    <label>Trigger status</label>
                    <div class="checkbox-group scoring-option-grid">
                        <label class="checkbox-label"><input type="radio" name="score_stk15m_trigger_status" value="confirmed"><span class="checkbox-text">Confirmed</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk15m_trigger_status" value="failed"><span class="checkbox-text">Failed</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk15m_trigger_status" value="no_trigger"><span class="checkbox-text">No trigger</span></label>
                    </div>
                </div>
                <div class="form-group">
                    <label>Volume</label>
                    <div class="checkbox-group scoring-option-grid">
                        <label class="checkbox-label"><input type="radio" name="score_stk15m_volume" value="increasing_move"><span class="checkbox-text">Increasing on move</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk15m_volume" value="reduced_pullbacks"><span class="checkbox-text">Reduced on pullbacks</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk15m_volume" value="weak"><span class="checkbox-text">Weak / no confirm</span></label>
                    </div>
                </div>
                <div class="form-group">
                    <label>Stop logic</label>
                    <div class="checkbox-group scoring-option-grid">
                        <label class="checkbox-label"><input type="radio" name="score_stk15m_stop_logic" value="below_last_hl"><span class="checkbox-text">Below last HL</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk15m_stop_logic" value="below_sweep_low"><span class="checkbox-text">Below sweep low</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk15m_stop_logic" value="below_vwap"><span class="checkbox-text">Below VWAP</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk15m_stop_logic" value="below_ema20"><span class="checkbox-text">Below EMA20</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk15m_stop_logic" value="above_last_lh"><span class="checkbox-text">Above last LH</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk15m_stop_logic" value="above_sweep_high"><span class="checkbox-text">Above sweep high</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk15m_stop_logic" value="structure_invalidation"><span class="checkbox-text">Structure invalidation</span></label>
                    </div>
                </div>
                <div class="form-group">
                    <label>Time of day</label>
                    <div class="checkbox-group scoring-option-grid">
                        <label class="checkbox-label"><input type="radio" name="score_stk15m_time_of_day" value="open"><span class="checkbox-text">Open</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk15m_time_of_day" value="midday"><span class="checkbox-text">Midday</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk15m_time_of_day" value="power_hour"><span class="checkbox-text">Power hour</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk15m_time_of_day" value="after_lunch_reclaim"><span class="checkbox-text">After lunch reclaim</span></label>
                    </div>
                </div>
                <div class="form-group">
                    <label>Liquidity event</label>
                    <div class="checkbox-group scoring-option-grid">
                        <label class="checkbox-label"><input type="radio" name="score_stk15m_liquidity_event" value="stop_run_low"><span class="checkbox-text">Stop run low</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk15m_liquidity_event" value="stop_run_high"><span class="checkbox-text">Stop run high</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk15m_liquidity_event" value="failed_breakout"><span class="checkbox-text">Failed breakout</span></label>
                        <label class="checkbox-label"><input type="radio" name="score_stk15m_liquidity_event" value="none"><span class="checkbox-text">None</span></label>
                    </div>
                </div>
                <div class="form-group">
                    <label>Entry</label>
                    <input name="score_stk15m_entry" type="text" placeholder="Entry">
                    <label style="margin-top:6px;">Stop</label>
                    <input name="score_stk15m_stop" type="text" placeholder="Stop" style="margin-top:6px;">
                    <label style="margin-top:6px;">Target</label>
                    <input name="score_stk15m_target" type="text" placeholder="Target" style="margin-top:6px;">
                </div>
                <div class="form-group" style="grid-column: 1 / -1;">
                    <label>Note</label>
                    <textarea name="score_stk15m_note" rows="2" placeholder="1 line"></textarea>
                </div>
            </div>
        </div>
        <div class="analysis-subsection">
            <h4>Output</h4>
            <div class="scoring-stage-grid">
                <div class="form-group">
                    <label>Status</label>
                    <div id="score-stk15m-status" class="scoring-readonly-value">No data</div>
                </div>
                <div class="form-group">
                    <label>R:R</label>
                    <div id="score-stk15m-rr" class="scoring-readonly-value">No data</div>
                </div>
                <div class="form-group">
                    <label>Breakdown</label>
                    <div id="score-stk15m-breakdown" class="scoring-readonly-value">Context: 0/5 | Trigger: 0/5 | Entry: 0/5 | Risk: 0/5 | Penalties: 0</div>
                </div>
            </div>
        </div>
    </div>

    <div class="analysis-section score-decision-section">
        <div class="scoring-header-row">
            <h3>Decision</h3>
            <div class="scoring-header-summary">
                <div><strong>Final:</strong> <span id="score-decision-overall-head">No data</span></div>
            </div>
        </div>
        <div class="analysis-subsection">
            <div class="scoring-stage-grid">
                <div class="form-group" style="grid-column: 1 / -1;">
                    <label>Decision</label>
                    <div id="score-decision-text" class="scoring-readonly-value">No data</div>
                </div>
                <div class="form-group" style="grid-column: 1 / -1;">
                    <details>
                        <summary>Swing options checklist</summary>
                        <div class="table-wrap" style="margin-top:8px;">
                            <table class="score-result-table">
                                <thead>
                                    <tr>
                                        <th>Condition</th>
                                        <th>Current</th>
                                        <th>7-14 DTE</th>
                                        <th>15-30 DTE</th>
                                        <th>30-60 DTE</th>
                                    </tr>
                                </thead>
                                <tbody id="score-decision-checklist-body">
                                    <tr><td colspan="5">No data</td></tr>
                                </tbody>
                            </table>
                        </div>
                    </details>
                </div>
            </div>
        </div>
    </div>

    <div class="analysis-section">
        <div class="scoring-header-row">
            <h3>History</h3>
            <div class="scoring-header-summary">
                <div><a class="btn btn-secondary" href="/score/snapshots/export.csv">Export CSV</a></div>
            </div>
        </div>
        <div class="scoring-stage-grid">
            <div class="form-group">
                <label for="score-session-date">Session date</label>
                <input id="score-session-date" name="score_session_date" type="date">
            </div>
            <div class="form-group">
                <label>&nbsp;</label>
                <div class="form-actions">
                    <button type="button" class="btn btn-primary" id="score-save-snapshot">Save snapshot</button>
                    <button type="button" class="btn btn-secondary" id="score-refresh-history">Refresh</button>
                </div>
            </div>
            <div class="form-group">
                <label>Status</label>
                <div id="score-history-status" class="scoring-readonly-value">No snapshot saved yet.</div>
            </div>
        </div>
        <div class="table-wrap">
            <table class="score-result-table">
                <thead>
                    <tr>
                        <th>Date</th>
                        <th>Total (All Sectors)</th>
                        <th>Sector Breakdown</th>
                        <th>Size</th>
                        <th>Risk State</th>
                        <th>Load</th>
                    </tr>
                </thead>
                <tbody id="score-history-body">
                    <tr><td colspan="6">No data</td></tr>
                </tbody>
            </table>
        </div>
    </div>
</form>
{% endblock %}




